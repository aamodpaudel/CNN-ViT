{"cells":[{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XIvd0rWhQvYo","executionInfo":{"status":"ok","timestamp":1744583234394,"user_tz":240,"elapsed":29067,"user":{"displayName":"","userId":""}},"outputId":"9c8cf18a-5da8-4f38-8545-91706e465c94"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["%cd /content/drive/MyDrive/Phase3"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fhM5MynVRCIM","executionInfo":{"status":"ok","timestamp":1744583301295,"user_tz":240,"elapsed":16,"user":{"displayName":"","userId":""}},"outputId":"e2003176-4fb8-430d-cfdb-87f597ef2259"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/Phase3\n"]}]},{"cell_type":"code","source":["!pip install torch torchvision matplotlib tqdm pillow numpy torchviz scikit-learn\n"],"metadata":{"id":"wlF0nWMnRS3K"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["!python augmentation.py"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RFRqH9dHR_I8","executionInfo":{"status":"ok","timestamp":1744584582536,"user_tz":240,"elapsed":852718,"user":{"displayName":"","userId":""}},"outputId":"de0204d4-c694-49c7-cae9-9d364007a858"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Emotion: happy - Original count: 1745\n","For emotion 'happy', augmenting 5255 images.\n","Final count for emotion 'happy': 7000\n","Emotion: angry - Original count: 2120\n","For emotion 'angry', augmenting 4880 images.\n","Final count for emotion 'angry': 7000\n","Emotion: relaxed - Original count: 1621\n","For emotion 'relaxed', augmenting 5379 images.\n","Final count for emotion 'relaxed': 7000\n","Emotion: sad - Original count: 1831\n","For emotion 'sad', augmenting 5169 images.\n","Final count for emotion 'sad': 7000\n","Augmentation complete. Each category now has 7000 images in the 'augmented_data' folder.\n"]}]},{"cell_type":"code","source":["!python split.py"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9cNgKCsPYmVB","executionInfo":{"status":"ok","timestamp":1744585661797,"user_tz":240,"elapsed":385834,"user":{"displayName":"","userId":""}},"outputId":"81bc26fa-2fe5-4d11-ae87-d84a76d90cf5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Emotion 'happy' split: Total=7000, Train=5000, Test=1000, Val=1000\n","Emotion 'angry' split: Total=7000, Train=5000, Test=1000, Val=1000\n","Emotion 'relaxed' split: Total=7000, Train=5000, Test=1000, Val=1000\n","Emotion 'sad' split: Total=7000, Train=5000, Test=1000, Val=1000\n","Data splitting complete. See folder 'augmented_data_split' for train, test and validation sets.\n"]}]},{"cell_type":"code","source":["!python train.py"],"metadata":{"id":"VKBuun3lvP87","executionInfo":{"status":"ok","timestamp":1744594389561,"user_tz":240,"elapsed":2873845,"user":{"displayName":"","userId":""}},"outputId":"cf92f411-b7b4-4f1a-ef98-a8424f5af2c7","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/usr/local/lib/python3.11/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.\n","  warnings.warn(\n","/usr/local/lib/python3.11/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.\n","  warnings.warn(msg)\n","/usr/local/lib/python3.11/dist-packages/torch/nn/modules/transformer.py:385: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)\n","  warnings.warn(\n","/content/drive/MyDrive/Phase3/train.py:119: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.\n","  scaler = torch.cuda.amp.GradScaler()\n","Epoch 1/50 Training:   0% 0/20000 [00:00<?, ?img/s]/content/drive/MyDrive/Phase3/train.py:143: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.\n","  with torch.cuda.amp.autocast():\n","Epoch 1/50 Training: 100% 20000/20000 [01:07<00:00, 297.00img/s]\n","/content/drive/MyDrive/Phase3/train.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.\n","  with torch.cuda.amp.autocast():\n","/content/drive/MyDrive/Phase3/train.py:187: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.\n","  with torch.cuda.amp.autocast():\n","\n","Epoch 1 complete:\n","  Train Loss: 1.0932 - Train Acc: 0.5302\n","  Val Loss:   0.9546 - Val Acc:   0.6162\n","  Test Loss:  0.9405 - Test Acc:  0.6215\n","\n","Epoch 2/50 Training: 100% 20000/20000 [00:40<00:00, 495.69img/s]\n","\n","Epoch 2 complete:\n","  Train Loss: 0.7300 - Train Acc: 0.7184\n","  Val Loss:   0.7730 - Val Acc:   0.7060\n","  Test Loss:  0.7738 - Test Acc:  0.7107\n","\n","Epoch 3/50 Training: 100% 20000/20000 [00:40<00:00, 492.46img/s]\n","\n","Epoch 3 complete:\n","  Train Loss: 0.4520 - Train Acc: 0.8371\n","  Val Loss:   0.7267 - Val Acc:   0.7368\n","  Test Loss:  0.7259 - Test Acc:  0.7395\n","\n","Epoch 4/50 Training: 100% 20000/20000 [00:40<00:00, 494.92img/s]\n","\n","Epoch 4 complete:\n","  Train Loss: 0.3001 - Train Acc: 0.8939\n","  Val Loss:   0.9683 - Val Acc:   0.7027\n","  Test Loss:  0.9422 - Test Acc:  0.7095\n","\n","Epoch 5/50 Training: 100% 20000/20000 [00:40<00:00, 497.28img/s]\n","\n","Epoch 5 complete:\n","  Train Loss: 0.2382 - Train Acc: 0.9165\n","  Val Loss:   0.7714 - Val Acc:   0.7530\n","  Test Loss:  0.7709 - Test Acc:  0.7580\n","\n","Epoch 6/50 Training: 100% 20000/20000 [00:40<00:00, 497.26img/s]\n","\n","Epoch 6 complete:\n","  Train Loss: 0.0855 - Train Acc: 0.9714\n","  Val Loss:   0.7552 - Val Acc:   0.8097\n","  Test Loss:  0.6897 - Test Acc:  0.8193\n","\n","Epoch 7/50 Training: 100% 20000/20000 [00:40<00:00, 496.78img/s]\n","\n","Epoch 7 complete:\n","  Train Loss: 0.0400 - Train Acc: 0.9870\n","  Val Loss:   0.8400 - Val Acc:   0.8103\n","  Test Loss:  0.8463 - Test Acc:  0.8087\n","\n","Epoch 8/50 Training: 100% 20000/20000 [00:40<00:00, 494.42img/s]\n","\n","Epoch 8 complete:\n","  Train Loss: 0.0433 - Train Acc: 0.9858\n","  Val Loss:   0.8931 - Val Acc:   0.8097\n","  Test Loss:  0.8754 - Test Acc:  0.8050\n","\n","Epoch 9/50 Training: 100% 20000/20000 [00:40<00:00, 496.40img/s]\n","\n","Epoch 9 complete:\n","  Train Loss: 0.0470 - Train Acc: 0.9849\n","  Val Loss:   0.7930 - Val Acc:   0.8097\n","  Test Loss:  0.8290 - Test Acc:  0.8095\n","\n","Epoch 10/50 Training: 100% 20000/20000 [00:40<00:00, 490.28img/s]\n","\n","Epoch 10 complete:\n","  Train Loss: 0.0437 - Train Acc: 0.9850\n","  Val Loss:   0.7386 - Val Acc:   0.8193\n","  Test Loss:  0.7585 - Test Acc:  0.8143\n","\n","Epoch 11/50 Training: 100% 20000/20000 [00:40<00:00, 489.70img/s]\n","\n","Epoch 11 complete:\n","  Train Loss: 0.0174 - Train Acc: 0.9939\n","  Val Loss:   0.8605 - Val Acc:   0.8183\n","  Test Loss:  0.8828 - Test Acc:  0.8175\n","\n","Epoch 12/50 Training: 100% 20000/20000 [00:40<00:00, 494.75img/s]\n","\n","Epoch 12 complete:\n","  Train Loss: 0.0111 - Train Acc: 0.9963\n","  Val Loss:   0.8892 - Val Acc:   0.8287\n","  Test Loss:  0.9479 - Test Acc:  0.8200\n","\n","Epoch 13/50 Training: 100% 20000/20000 [00:40<00:00, 494.76img/s]\n","\n","Epoch 13 complete:\n","  Train Loss: 0.0094 - Train Acc: 0.9972\n","  Val Loss:   0.9736 - Val Acc:   0.8295\n","  Test Loss:  1.0069 - Test Acc:  0.8227\n","\n","Epoch 14/50 Training: 100% 20000/20000 [00:40<00:00, 491.26img/s]\n","\n","Epoch 14 complete:\n","  Train Loss: 0.0125 - Train Acc: 0.9960\n","  Val Loss:   0.9339 - Val Acc:   0.8280\n","  Test Loss:  0.9431 - Test Acc:  0.8193\n","\n","Epoch 15/50 Training: 100% 20000/20000 [00:40<00:00, 495.39img/s]\n","\n","Epoch 15 complete:\n","  Train Loss: 0.0145 - Train Acc: 0.9954\n","  Val Loss:   0.9403 - Val Acc:   0.8295\n","  Test Loss:  0.9614 - Test Acc:  0.8217\n","\n","Epoch 16/50 Training: 100% 20000/20000 [00:40<00:00, 498.07img/s]\n","\n","Epoch 16 complete:\n","  Train Loss: 0.0060 - Train Acc: 0.9980\n","  Val Loss:   0.8707 - Val Acc:   0.8365\n","  Test Loss:  0.9298 - Test Acc:  0.8330\n","\n","Epoch 17/50 Training: 100% 20000/20000 [00:40<00:00, 498.10img/s]\n","\n","Epoch 17 complete:\n","  Train Loss: 0.0040 - Train Acc: 0.9990\n","  Val Loss:   0.9421 - Val Acc:   0.8345\n","  Test Loss:  1.0270 - Test Acc:  0.8227\n","\n","Epoch 18/50 Training: 100% 20000/20000 [00:40<00:00, 497.09img/s]\n","\n","Epoch 18 complete:\n","  Train Loss: 0.0022 - Train Acc: 0.9992\n","  Val Loss:   1.0071 - Val Acc:   0.8365\n","  Test Loss:  1.0912 - Test Acc:  0.8277\n","\n","Epoch 19/50 Training: 100% 20000/20000 [00:40<00:00, 497.08img/s]\n","\n","Epoch 19 complete:\n","  Train Loss: 0.0051 - Train Acc: 0.9984\n","  Val Loss:   1.0077 - Val Acc:   0.8357\n","  Test Loss:  1.0713 - Test Acc:  0.8263\n","\n","Epoch 20/50 Training: 100% 20000/20000 [00:40<00:00, 493.40img/s]\n","\n","Epoch 20 complete:\n","  Train Loss: 0.0031 - Train Acc: 0.9990\n","  Val Loss:   1.0478 - Val Acc:   0.8403\n","  Test Loss:  1.1167 - Test Acc:  0.8323\n","\n","Epoch 21/50 Training: 100% 20000/20000 [00:40<00:00, 492.06img/s]\n","\n","Epoch 21 complete:\n","  Train Loss: 0.0020 - Train Acc: 0.9991\n","  Val Loss:   1.0477 - Val Acc:   0.8417\n","  Test Loss:  1.1056 - Test Acc:  0.8340\n","\n","Epoch 22/50 Training: 100% 20000/20000 [00:40<00:00, 495.37img/s]\n","\n","Epoch 22 complete:\n","  Train Loss: 0.0016 - Train Acc: 0.9996\n","  Val Loss:   1.0492 - Val Acc:   0.8448\n","  Test Loss:  1.1228 - Test Acc:  0.8393\n","\n","Epoch 23/50 Training: 100% 20000/20000 [00:40<00:00, 497.76img/s]\n","\n","Epoch 23 complete:\n","  Train Loss: 0.0005 - Train Acc: 0.9999\n","  Val Loss:   1.0904 - Val Acc:   0.8427\n","  Test Loss:  1.1560 - Test Acc:  0.8403\n","\n","Epoch 24/50 Training: 100% 20000/20000 [00:40<00:00, 493.81img/s]\n","\n","Epoch 24 complete:\n","  Train Loss: 0.0007 - Train Acc: 0.9998\n","  Val Loss:   1.1161 - Val Acc:   0.8425\n","  Test Loss:  1.1876 - Test Acc:  0.8430\n","\n","Epoch 25/50 Training: 100% 20000/20000 [00:40<00:00, 496.83img/s]\n","\n","Epoch 25 complete:\n","  Train Loss: 0.0013 - Train Acc: 0.9995\n","  Val Loss:   1.1248 - Val Acc:   0.8478\n","  Test Loss:  1.1725 - Test Acc:  0.8387\n","\n","Epoch 26/50 Training: 100% 20000/20000 [00:40<00:00, 498.38img/s]\n","\n","Epoch 26 complete:\n","  Train Loss: 0.0009 - Train Acc: 0.9999\n","  Val Loss:   1.1416 - Val Acc:   0.8400\n","  Test Loss:  1.1920 - Test Acc:  0.8380\n","\n","Epoch 27/50 Training: 100% 20000/20000 [00:40<00:00, 494.74img/s]\n","\n","Epoch 27 complete:\n","  Train Loss: 0.0010 - Train Acc: 0.9996\n","  Val Loss:   1.1268 - Val Acc:   0.8452\n","  Test Loss:  1.2007 - Test Acc:  0.8395\n","\n","Epoch 28/50 Training: 100% 20000/20000 [00:40<00:00, 497.35img/s]\n","\n","Epoch 28 complete:\n","  Train Loss: 0.0002 - Train Acc: 1.0000\n","  Val Loss:   1.1289 - Val Acc:   0.8462\n","  Test Loss:  1.1869 - Test Acc:  0.8407\n","\n","Epoch 29/50 Training: 100% 20000/20000 [00:40<00:00, 495.67img/s]\n","\n","Epoch 29 complete:\n","  Train Loss: 0.0003 - Train Acc: 1.0000\n","  Val Loss:   1.1419 - Val Acc:   0.8472\n","  Test Loss:  1.2072 - Test Acc:  0.8397\n","\n","Epoch 30/50 Training: 100% 20000/20000 [00:40<00:00, 494.49img/s]\n","\n","Epoch 30 complete:\n","  Train Loss: 0.0002 - Train Acc: 1.0000\n","  Val Loss:   1.1757 - Val Acc:   0.8458\n","  Test Loss:  1.2505 - Test Acc:  0.8415\n","\n","Epoch 31/50 Training: 100% 20000/20000 [00:40<00:00, 491.37img/s]\n","\n","Epoch 31 complete:\n","  Train Loss: 0.0004 - Train Acc: 0.9999\n","  Val Loss:   1.1697 - Val Acc:   0.8430\n","  Test Loss:  1.2385 - Test Acc:  0.8403\n","\n","Epoch 32/50 Training: 100% 20000/20000 [00:40<00:00, 492.53img/s]\n","\n","Epoch 32 complete:\n","  Train Loss: 0.0005 - Train Acc: 0.9999\n","  Val Loss:   1.1524 - Val Acc:   0.8482\n","  Test Loss:  1.2328 - Test Acc:  0.8440\n","\n","Epoch 33/50 Training: 100% 20000/20000 [00:40<00:00, 495.38img/s]\n","\n","Epoch 33 complete:\n","  Train Loss: 0.0003 - Train Acc: 0.9999\n","  Val Loss:   1.1698 - Val Acc:   0.8450\n","  Test Loss:  1.2561 - Test Acc:  0.8397\n","\n","Epoch 34/50 Training: 100% 20000/20000 [00:40<00:00, 495.47img/s]\n","\n","Epoch 34 complete:\n","  Train Loss: 0.0006 - Train Acc: 0.9999\n","  Val Loss:   1.1570 - Val Acc:   0.8502\n","  Test Loss:  1.2530 - Test Acc:  0.8380\n","\n","Epoch 35/50 Training: 100% 20000/20000 [00:40<00:00, 494.08img/s]\n","\n","Epoch 35 complete:\n","  Train Loss: 0.0003 - Train Acc: 0.9999\n","  Val Loss:   1.1610 - Val Acc:   0.8478\n","  Test Loss:  1.2509 - Test Acc:  0.8405\n","\n","Epoch 36/50 Training: 100% 20000/20000 [00:40<00:00, 492.45img/s]\n","\n","Epoch 36 complete:\n","  Train Loss: 0.0005 - Train Acc: 0.9998\n","  Val Loss:   1.1528 - Val Acc:   0.8480\n","  Test Loss:  1.2405 - Test Acc:  0.8415\n","\n","Epoch 37/50 Training: 100% 20000/20000 [00:40<00:00, 493.46img/s]\n","\n","Epoch 37 complete:\n","  Train Loss: 0.0005 - Train Acc: 0.9999\n","  Val Loss:   1.1667 - Val Acc:   0.8472\n","  Test Loss:  1.2565 - Test Acc:  0.8415\n","\n","Epoch 38/50 Training: 100% 20000/20000 [00:40<00:00, 498.24img/s]\n","\n","Epoch 38 complete:\n","  Train Loss: 0.0001 - Train Acc: 1.0000\n","  Val Loss:   1.1503 - Val Acc:   0.8508\n","  Test Loss:  1.2524 - Test Acc:  0.8403\n","\n","Epoch 39/50 Training: 100% 20000/20000 [00:40<00:00, 495.05img/s]\n","\n","Epoch 39 complete:\n","  Train Loss: 0.0004 - Train Acc: 0.9999\n","  Val Loss:   1.1575 - Val Acc:   0.8492\n","  Test Loss:  1.2399 - Test Acc:  0.8430\n","\n","Epoch 40/50 Training: 100% 20000/20000 [00:40<00:00, 491.09img/s]\n","\n","Epoch 40 complete:\n","  Train Loss: 0.0001 - Train Acc: 1.0000\n","  Val Loss:   1.1795 - Val Acc:   0.8470\n","  Test Loss:  1.2593 - Test Acc:  0.8385\n","\n","Epoch 41/50 Training: 100% 20000/20000 [00:40<00:00, 493.82img/s]\n","\n","Epoch 41 complete:\n","  Train Loss: 0.0002 - Train Acc: 1.0000\n","  Val Loss:   1.1692 - Val Acc:   0.8475\n","  Test Loss:  1.2518 - Test Acc:  0.8430\n","\n","Epoch 42/50 Training: 100% 20000/20000 [00:40<00:00, 494.09img/s]\n","\n","Epoch 42 complete:\n","  Train Loss: 0.0001 - Train Acc: 1.0000\n","  Val Loss:   1.1788 - Val Acc:   0.8468\n","  Test Loss:  1.2576 - Test Acc:  0.8417\n","\n","Epoch 43/50 Training: 100% 20000/20000 [00:40<00:00, 497.00img/s]\n","\n","Epoch 43 complete:\n","  Train Loss: 0.0002 - Train Acc: 0.9999\n","  Val Loss:   1.1659 - Val Acc:   0.8498\n","  Test Loss:  1.2465 - Test Acc:  0.8433\n","\n","Epoch 44/50 Training: 100% 20000/20000 [00:40<00:00, 493.92img/s]\n","\n","Epoch 44 complete:\n","  Train Loss: 0.0005 - Train Acc: 0.9999\n","  Val Loss:   1.1669 - Val Acc:   0.8508\n","  Test Loss:  1.2537 - Test Acc:  0.8460\n","\n","Epoch 45/50 Training: 100% 20000/20000 [00:40<00:00, 490.35img/s]\n","\n","Epoch 45 complete:\n","  Train Loss: 0.0006 - Train Acc: 0.9999\n","  Val Loss:   1.1930 - Val Acc:   0.8460\n","  Test Loss:  1.2576 - Test Acc:  0.8403\n","\n","Epoch 46/50 Training: 100% 20000/20000 [00:40<00:00, 496.99img/s]\n","\n","Epoch 46 complete:\n","  Train Loss: 0.0002 - Train Acc: 1.0000\n","  Val Loss:   1.1680 - Val Acc:   0.8480\n","  Test Loss:  1.2473 - Test Acc:  0.8430\n","\n","Epoch 47/50 Training: 100% 20000/20000 [00:40<00:00, 490.15img/s]\n","\n","Epoch 47 complete:\n","  Train Loss: 0.0003 - Train Acc: 0.9999\n","  Val Loss:   1.1749 - Val Acc:   0.8478\n","  Test Loss:  1.2478 - Test Acc:  0.8460\n","\n","Epoch 48/50 Training: 100% 20000/20000 [00:40<00:00, 495.56img/s]\n","\n","Epoch 48 complete:\n","  Train Loss: 0.0001 - Train Acc: 1.0000\n","  Val Loss:   1.1596 - Val Acc:   0.8542\n","  Test Loss:  1.2464 - Test Acc:  0.8448\n","\n","Epoch 49/50 Training: 100% 20000/20000 [00:40<00:00, 494.71img/s]\n","\n","Epoch 49 complete:\n","  Train Loss: 0.0001 - Train Acc: 1.0000\n","  Val Loss:   1.1649 - Val Acc:   0.8502\n","  Test Loss:  1.2504 - Test Acc:  0.8438\n","\n","Epoch 50/50 Training: 100% 20000/20000 [00:40<00:00, 493.47img/s]\n","\n","Epoch 50 complete:\n","  Train Loss: 0.0002 - Train Acc: 1.0000\n","  Val Loss:   1.1680 - Val Acc:   0.8512\n","  Test Loss:  1.2510 - Test Acc:  0.8420\n","\n","Training complete and model saved.\n","All figures generated and saved.\n"]}]}],"metadata":{"colab":{"provenance":[{"file_id":"/v2/external/notebooks/pro.ipynb","timestamp":1744594976540}],"machine_shape":"hm","gpuType":"A100"},"kernelspec":{"display_name":"Python 3","name":"python3"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}